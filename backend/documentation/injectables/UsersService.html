<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>kairos-api documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>
          <script>
               // Blocking script to avoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-md-none p-0">
               <div class="d-flex">
                    <a href="../" class="navbar-brand">kairos-api documentation</a>
                    <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
               </div>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="d-none d-md-block menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">








<ol class="breadcrumb">
  <li class="breadcrumb-item">Injectables</li>
  <li class="breadcrumb-item" >UsersService</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/users/users.service.ts</code>
        </p>



            <p class="comment">
                <h3>Extends</h3>
            </p>
            <p class="comment">
                            <code><a href="../classes/DefaultService.html" target="_self" >DefaultService</a></code>
            </p>


            <section data-compodoc="block-index">
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#categoryRepository" >categoryRepository</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#paymentMethodRepository" >paymentMethodRepository</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#userRepository" >userRepository</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#userRoleRepository" >userRoleRepository</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#logger" >logger</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Async</span>
                                <a href="#_hashPassword" >_hashPassword</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#all" >all</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#create" >create</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#delete" >delete</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getBy" >getBy</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#update" >update</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section data-compodoc="block-constructor">
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor()</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="24" class="link-to-prism">src/users/users.service.ts:24</a></div>
                            </td>
                        </tr>

            </tbody>
        </table>
</section>

            <section data-compodoc="block-methods">
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="_hashPassword"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Async</span>
                        <span ><b>_hashPassword</b></span>
                        <a href="#_hashPassword"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>_hashPassword(password: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="30"
                                    class="link-to-prism">src/users/users.service.ts:30</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>password</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;string&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="all"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>all</b></span>
                        <a href="#all"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>all(params: literal type)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="109"
                                    class="link-to-prism">src/users/users.service.ts:109</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>params</td>
                                            <td>
                                                        <code>literal type</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;ResposeResultsPaginationDTO&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="create"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>create</b></span>
                        <a href="#create"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>create(files: literal type, params: literal type)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="242"
                                    class="link-to-prism">src/users/users.service.ts:242</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>files</td>
                                            <td>
                                                        <code>literal type</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>params</td>
                                            <td>
                                                        <code>literal type</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../classes/User.html" target="_self" >Promise&lt;User&gt;</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="delete"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>delete</b></span>
                        <a href="#delete"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>delete(params: literal type)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="454"
                                    class="link-to-prism">src/users/users.service.ts:454</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>params</td>
                                            <td>
                                                        <code>literal type</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../classes/User.html" target="_self" >Promise&lt;User&gt;</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getBy"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>getBy</b></span>
                        <a href="#getBy"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getBy(params: literal type)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="35"
                                    class="link-to-prism">src/users/users.service.ts:35</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>params</td>
                                            <td>
                                                        <code>literal type</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../classes/User.html" target="_self" >Promise&lt;User&gt;</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="update"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>update</b></span>
                        <a href="#update"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>update(files: literal type, params: literal type)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="331"
                                    class="link-to-prism">src/users/users.service.ts:331</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>files</td>
                                            <td>
                                                        <code>literal type</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>params</td>
                                            <td>
                                                        <code>literal type</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../classes/User.html" target="_self" >Promise&lt;User&gt;</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>
            <section data-compodoc="block-properties">
    
    <h3 id="inputs">
        Properties
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="categoryRepository"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier">Private</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>categoryRepository</b></span>
                        <a href="#categoryRepository"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="../entitys/Category.html" target="_self" >Repository&lt;Category&gt;</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <b>Decorators : </b>
                        <br />
                        <code>
                            @InjectRepository(Category)<br />
                        </code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="22" class="link-to-prism">src/users/users.service.ts:22</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="paymentMethodRepository"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier">Private</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>paymentMethodRepository</b></span>
                        <a href="#paymentMethodRepository"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="../entitys/PaymentMethod.html" target="_self" >Repository&lt;PaymentMethod&gt;</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <b>Decorators : </b>
                        <br />
                        <code>
                            @InjectRepository(PaymentMethod)<br />
                        </code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="24" class="link-to-prism">src/users/users.service.ts:24</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="userRepository"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier">Private</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>userRepository</b></span>
                        <a href="#userRepository"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="../classes/User.html" target="_self" >Repository&lt;User&gt;</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <b>Decorators : </b>
                        <br />
                        <code>
                            @InjectRepository(User)<br />
                        </code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="18" class="link-to-prism">src/users/users.service.ts:18</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="userRoleRepository"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier">Private</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>userRoleRepository</b></span>
                        <a href="#userRoleRepository"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="../entitys/Role.html" target="_self" >Repository&lt;Role&gt;</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <b>Decorators : </b>
                        <br />
                        <code>
                            @InjectRepository(Role)<br />
                        </code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="20" class="link-to-prism">src/users/users.service.ts:20</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="logger"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>logger</b></span>
                        <a href="#logger"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>Logger</code>

                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Inherited from         <code><a href="../classes/DefaultService.html" target="_self" >DefaultService</a></code>
</div>
                            </td>
                        </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in         <code><a href="../classes/DefaultService.html#source" target="_self" >DefaultService:4</a></code>
</div>
                        </td>
                    </tr>


        </tbody>
    </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable } from &#x27;@nestjs/common&#x27;;
import { InjectRepository } from &#x27;@nestjs/typeorm&#x27;;
import * as bcrypt from &#x27;bcrypt&#x27;;
import { ResposeResultsPaginationDTO } from &#x27;src/app/api.dto&#x27;;
import { DefaultService } from &#x27;src/app/defaults/defatul.service&#x27;;
import { RoleEnum } from &#x27;src/roles/role.enum&#x27;;
import { Role } from &#x27;src/roles/roles.entity&#x27;;
import { CreateUserDTO, SearchUserDTO, SearchUserPaginationDTO, UpdateUserDTO } from &#x27;src/users/users.dto&#x27;;
import { User } from &#x27;src/users/users.entity&#x27;;
import { UserAlreadyExistsException, UserNoExistsException } from &#x27;src/users/users.exception&#x27;;
import { Category } from &#x27;src/categories/entities/category.entity&#x27;;
import { PaymentMethod } from &#x27;src/paymentMethod/entities/paymentMethod.entity&#x27;;
import { In, IsNull, Like, Repository } from &#x27;typeorm&#x27;;
import { saveFiles } from &#x27;../app/utils/filePersistor&#x27;;
@Injectable()
export class UsersService extends DefaultService {
  @InjectRepository(User)
  private readonly userRepository: Repository&lt;User&gt;;
  @InjectRepository(Role)
  private readonly userRoleRepository: Repository&lt;Role&gt;;
  @InjectRepository(Category)
  private readonly categoryRepository: Repository&lt;Category&gt;;
  @InjectRepository(PaymentMethod)
  private readonly paymentMethodRepository: Repository&lt;PaymentMethod&gt;;

  constructor() {
    super(UsersService);
  }

  private async _hashPassword(password: string): Promise&lt;string&gt; {
    const salt &#x3D; await bcrypt.genSalt(8);
    return await bcrypt.hash(password, salt);
  }

  async getBy(params: { query: SearchUserDTO; withPassword?: boolean }): Promise&lt;User&gt; {
    try {
      const user &#x3D; await this.userRepository.findOne({
        select: {
          guid: true,
          name: true,
          lastname: true,
          document: true,
          email: true,
          profileImage: true,
          username: true,
          documentSideA: true,
          documentSideB: true,
          backgroundCheck: true,
          backgroundCheckDate: true,
          backgroundCheckExpirationDate: true,
          birthdate: true,
          address: true,
          phone: true,
          mapAdress: true,
          isActive: true,
          googleID: true,
          createdAt: true,
          updatedAt: true,
          availability: true,
          isAvailable: true,
          certifications: true,
          previusWorks: true,
          description: true,
          category: {
            guid: true,
            name: true,
            description: true
          },


          paymentMethod: {
            guid: true,
            name: true
          },
          password: params.withPassword || false,
          createdBy: {
            guid: true,
            name: true,
            lastname: true,
            email: true,
            username: true,
            createdAt: true,
            updatedAt: true,
            password: false
          }
        },
        relations: [&#x27;role&#x27;, &#x27;createdBy&#x27;, &#x27;updatedBy&#x27;, &#x27;deletedBy&#x27;, &#x27;category&#x27;, &#x27;paymentMethod&#x27;],
        where: {
          guid: params.query.guid || undefined,
          username: params.query.username || undefined,
          googleID: params.query.googleID || undefined,
          email: params.query.email || undefined,
          document: params.query.document || undefined,
          isActive: params.query.isActive || undefined,
          deletedAt: IsNull()
        }
      });

      if (!user) throw new UserNoExistsException();
      user.availability &#x3D; JSON.parse(user.availability);
      user.certifications &#x3D; JSON.parse(user.certifications);
      user.previusWorks &#x3D; JSON.parse(user.previusWorks);
      return user;
    } catch (error) {
      throw new Error(&#x60;${UsersService.name}[getBy]:${error.message}&#x60;);
    }
  }

  async all(params: { query: SearchUserPaginationDTO }): Promise&lt;ResposeResultsPaginationDTO&gt; {
    const emptyResponse &#x3D; {
      total: 0,
      pageSize: 0,
      offset: params.query.offset,
      results: []
    };
    try {
      if (Object.keys(params.query).length &#x3D;&#x3D;&#x3D; 0) {
        return emptyResponse;
      }
      if (params.query.pageSize?.toString() &#x3D;&#x3D;&#x3D; &#x27;0&#x27;) {
        return emptyResponse;
      }

      const order &#x3D; {};
      if (params.query.orderBy &amp;&amp; params.query.orderType) {
        order[params.query.orderBy] &#x3D; params.query.orderType;
      }

      let categoriesIDs: Category[] &#x3D; [];
      if (params.query.categoryID) {
        categoriesIDs &#x3D; await Promise.all(
          params.query.categoryID
            .trim()
            .substring(1, params.query.categoryID.length - 1)
            .split(&#x27;,&#x27;)
            .map((jobType) &#x3D;&gt; jobType.trim())
            .map(async (categoryId) &#x3D;&gt; {
              const category &#x3D; await this.categoryRepository.findOneBy({
                guid: categoryId
              });
              if (!category) {
                throw new Error(&#x27;Category not found&#x27;);
              }
              return category;
            })
        );
      }

      const forPage: number &#x3D; parseInt(params.query.pageSize);
      const skip: number &#x3D; parseInt(params.query.offset);
      const [user, total] &#x3D; await this.userRepository.findAndCount({
        select: {
          guid: true,
          name: true,
          lastname: true,
          email: true,
          document: true,
          profileImage: true,
          documentSideA: true,
          documentSideB: true,
          backgroundCheck: true,
          backgroundCheckDate: true,
          backgroundCheckExpirationDate: true,
          username: true,
          birthdate: true,
          address: true,
          phone: true,
          mapAdress: true,
          availability: true,
          isActive: true,
          googleID: true,
          createdAt: true,
          updatedAt: true,
          paymentMethod: true,
          isAvailable: true,
          certifications: true,
          previusWorks: true,
          description: true,
          category: {
            guid: true,
            name: true,
            description: true
          },
          role: {
            guid: true,
            role: true,
            description: true
          },
          createdBy: {
            guid: true,
            name: true,
            lastname: true,
            email: true,
            username: true,
            createdAt: true,
            updatedAt: true,
            password: false
          }
        },
        relations: [&#x27;role&#x27;, &#x27;createdBy&#x27;, &#x27;updatedBy&#x27;, &#x27;deletedBy&#x27;, &#x27;category&#x27;, &#x27;paymentMethod&#x27;],
        where: {
          deletedAt: IsNull(),
          name: params.query.name ? Like(&#x60;%${params.query.name}%&#x60;) : undefined,
          lastname: params.query.lastname ? Like(&#x60;%${params.query.lastname}%&#x60;) : undefined,
          email: params.query.email ? Like(&#x60;%${params.query.email}%&#x60;) : undefined,
          document: params.query.document ? Like(&#x60;%${params.query.document}%&#x60;) : undefined,
          username: params.query.username ? Like(&#x60;%${params.query.username}%&#x60;) : undefined,
          isActive: params.query.isActive || undefined,
          mapAdress: params.query.mapAdress || undefined,
          phone: params.query.phone || undefined,
          role: {
            guid: params.query.roleGuid || undefined
          },
          category: {
            guid: categoriesIDs.length &gt; 0 ? In(categoriesIDs.map((category) &#x3D;&gt; category.guid)) : undefined,
            name: params.query.category ? Like(&#x60;%${params.query.category}%&#x60;) : undefined
          },
          paymentMethod: {
            guid: params.query.paymentMethod || undefined
          }
        },
        order,
        take: forPage,
        skip: skip
      });
      user.forEach((user) &#x3D;&gt; {
        user.availability &#x3D; JSON.parse(user.availability);
        user.certifications &#x3D; JSON.parse(user.certifications);
        user.previusWorks &#x3D; JSON.parse(user.previusWorks);
      });
      return {
        total: total,
        pageSize: forPage,
        offset: parseInt(params.query.offset),
        results: user
      };
    } catch (error) {
      throw new Error(&#x60;${UsersService.name}[all]:${error.message}&#x60;);
    }
  }

  async create(
    files: {
      profileImage?: Express.Multer.File;
      documentSideA?: Express.Multer.File;
      documentSideB?: Express.Multer.File;
      backgroundCheck?: Express.Multer.File;
      previusWorks?: Express.Multer.File[];
      certifications?: Express.Multer.File[];
    },
    params: {
      body: CreateUserDTO;
      createdByGUID?: string;
    }
  ): Promise&lt;User&gt; {
    try {
      saveFiles(files);
      let user &#x3D; await this.userRepository.findOneBy({
        username: params.body.username
      });
      if (user) {
        throw new UserAlreadyExistsException();
      }
      const hashedPassword: string &#x3D; await this._hashPassword(params.body.password);

      let categories: Category[] &#x3D; [];
      if (params.body.category) {
        categories &#x3D; await Promise.all(
          params.body.category
            .trim()
            .substring(1, params.body.category.length - 1)
            .split(&#x27;,&#x27;)
            .map((jobType) &#x3D;&gt; jobType.trim())
            .map(async (categoryId) &#x3D;&gt; {
              const category &#x3D; await this.categoryRepository.findOneBy({
                guid: categoryId
              });
              if (!category) {
                throw new Error(&#x27;Category not found&#x27;);
              }
              return category;
            })
        );
      }


      if (!params.body.roleGuid) {
        params.body.roleGuid &#x3D; &#x27;R02&#x27;;
      }
      user &#x3D; await this.userRepository.save({
        name: params.body.name,
        lastname: params.body.lastname,
        email: params.body.email,
        document: params.body.document || null,
        password: hashedPassword,
        googleID: params.body.googleID || null,
        username: params.body.username,
        birthdate: params.body.birthdate || null,
        address: params.body.address || null,
        mapAdress: params.body.mapAdress || null,
        phone: params.body.phone || null,
        profileImage: files?.profileImage?.[0]?.filename || &#x27;&#x27;,
        documentSideA: files?.documentSideA?.[0]?.filename || &#x27;&#x27;,
        documentSideB: files?.documentSideB?.[0]?.filename || &#x27;&#x27;,
        backgroundCheck: files?.backgroundCheck?.[0]?.filename || &#x27;&#x27;,
        backgroundCheckDate: params.body.backgroundCheckDate || null,
        backgroundCheckExpirationDate: params.body.backgroundCheckExpirationDate || null,
        certifications: JSON.stringify(files?.certifications?.map((certification) &#x3D;&gt; certification.filename)) || null,
        previusWorks: JSON.stringify(files?.previusWorks?.map((previusWork) &#x3D;&gt; previusWork.filename)) || null,
        description: params.body.description || null,
        isAvailable: params.body.isAvailable || 0,
        availability: JSON.stringify(params.body.availability) || null,
        paymentMethods: params.body.paymentMethods || null,
        category: categories || [],
        role: await this.userRoleRepository.findOneBy({
          guid: params.body.roleGuid
        }),
        isActive: params.body.isActive || 1,
        isProfessional: 0
      });
      user.createdBy &#x3D; (await this.userRepository.findOneBy({ guid: params.createdByGUID })) || user;
      delete user.createdBy;
      user.certifications &#x3D; JSON.parse(user.certifications);
      user.previusWorks &#x3D; JSON.parse(user.previusWorks);
      return user;
    } catch (error) {
      throw new Error(&#x60;${UsersService.name}[create]:${error.message}&#x60;);
    }
  }

  async update(
    files: {
      profileImage?: Express.Multer.File;
      documentSideA?: Express.Multer.File;
      documentSideB?: Express.Multer.File;
      backgroundCheck?: Express.Multer.File;
      previusWorks?: Express.Multer.File[];
      certifications?: Express.Multer.File[];
    },
    params: {
      guid: string;
      body: UpdateUserDTO;
      updatedByGUID: string;
    }
  ): Promise&lt;User&gt; {
    try {
      saveFiles(files);
      const user &#x3D; await this.userRepository.findOne({
        select: {
          paymentMethod: {
            guid: true,
            name: true
          }
        },
        where: { guid: params.guid, deletedAt: IsNull() },
        relations: [&#x27;role&#x27;, &#x27;createdBy&#x27;, &#x27;updatedBy&#x27;, &#x27;deletedBy&#x27;, &#x27;category&#x27;, &#x27;paymentMethod&#x27;]
      });
      if (!user) {
        throw new UserNoExistsException();
      }

      if (files?.documentSideA &amp;&amp; files?.documentSideB &amp;&amp; !params.body.isProfessional) {
        params.body.roleGuid &#x3D; RoleEnum.ServiceProvier;
      }

      let categories: Category[] &#x3D; [];
      if (params.body.category) {
        categories &#x3D; await Promise.all(
          params.body.category
            .trim()
            .substring(1, params.body.category.length - 1)
            .split(&#x27;,&#x27;)
            .map((jobType) &#x3D;&gt; jobType.trim())
            .map(async (categoryId) &#x3D;&gt; {
              const category &#x3D; await this.categoryRepository.findOneBy({
                guid: categoryId
              });
              if (!category) {
                throw new Error(&#x27;Category not found&#x27;);
              }
              return category;
            })
        );
      } else {
        categories &#x3D; user.category;
      }

      let paymentMethods: PaymentMethod[] &#x3D; [];
      if (params.body.paymentMethods) {
        paymentMethods &#x3D; await Promise.all(
          params.body.paymentMethods
            .trim()
            .substring(1, params.body.paymentMethods.length - 1)
            .split(&#x27;,&#x27;)
            .map((paymentMethod) &#x3D;&gt; paymentMethod.trim())
            .map(async (paymentMethodId) &#x3D;&gt; {
              const paymentMethod &#x3D; await this.paymentMethodRepository.findOneBy({
                guid: paymentMethodId
              });
              if (!paymentMethod) {
                throw new Error(&#x27;Payment Method not found&#x27;);
              }
              return paymentMethod;
            })
        );
      } else {
        paymentMethods &#x3D; user.paymentMethod;
        console.log(&#x27;payment from service&#x27;, user.paymentMethod);
      }

      user.name &#x3D; params.body.name || user.name;
      user.email &#x3D; params.body.email || user.email;
      user.address &#x3D; params.body.address || user.address;
      user.phone &#x3D; params.body.phone || user.phone;
      user.googleID &#x3D; params.body.googleID || user.googleID;
      user.birthdate &#x3D; params.body.birthdate || user.birthdate;
      user.profileImage &#x3D; files?.profileImage?.[0]?.filename || user.profileImage;
      user.documentSideA &#x3D; files?.documentSideA?.[0]?.filename || user.documentSideA;
      user.documentSideB &#x3D; files?.documentSideB?.[0]?.filename || user.documentSideB;
      user.backgroundCheck &#x3D; files?.backgroundCheck?.[0]?.filename || user.backgroundCheck;
      user.backgroundCheckExpirationDate &#x3D; params.body.backgroundCheckExpirationDate || user.backgroundCheckExpirationDate;
      user.backgroundCheckDate &#x3D; params.body.backgroundCheckDate || user.backgroundCheckDate;
      user.lastname &#x3D; params.body.lastname || user.lastname;
      user.username &#x3D; params.body.username || user.username;
      user.document &#x3D; params.body.document || user.document;
      user.mapAdress &#x3D; params.body.mapAdress || user.mapAdress;
      user.category &#x3D; categories || user.category;
      user.backgroundCheckDate &#x3D; params.body.backgroundCheckDate || user.backgroundCheckDate;
      user.password &#x3D; params.body.password ? await this._hashPassword(params.body.password) : user.password;
      user.isActive &#x3D; params.body.isActive !&#x3D;&#x3D; undefined ? params.body.isActive : user.isActive;
      user.isAvailable &#x3D; params.body.isAvailable !&#x3D;&#x3D; undefined ? params.body.isAvailable : user.isAvailable;
      user.availability &#x3D; JSON.stringify(params.body.availability) || user.availability;
      user.paymentMethod &#x3D; paymentMethods || user.paymentMethod;
      user.certifications &#x3D; JSON.stringify(files?.certifications?.map((certification) &#x3D;&gt; certification.filename)) || user.certifications;
      user.previusWorks &#x3D; JSON.stringify(files?.previusWorks?.map((previusWork) &#x3D;&gt; previusWork.filename)) || user.previusWorks;
      user.description &#x3D; params.body.description || user.description;
      if (params.body.roleGuid !&#x3D;&#x3D; undefined) {
        user.role &#x3D; await this.userRoleRepository.findOneBy({
          guid: params.body.roleGuid
        });
      }

      let newUser &#x3D; await this.userRepository.save(user);
      newUser.availability &#x3D; JSON.parse(newUser.availability);
      newUser.certifications &#x3D; newUser.certifications ? JSON.parse(newUser.certifications) : [];
      newUser.previusWorks &#x3D; newUser.previusWorks ? JSON.parse(newUser.previusWorks) : [];

      return newUser;
    } catch (error) {
      throw new Error(&#x60;${UsersService.name}[update]:${error.message}&#x60;);
    }
  }

  async delete(params: { guid: string; updatedByGUID: string }): Promise&lt;User&gt; {
    try {
      const userToDelete &#x3D; await this.userRepository.findOne({
        where: { guid: params.guid, deletedAt: IsNull() }
      });
      if (!userToDelete) {
        throw new UserNoExistsException();
      }

      const user &#x3D; await this.userRepository.findOne({
        where: { guid: params.updatedByGUID }
      });
      if (!user) {
        throw new Error(&#x27;UserNoExists&#x27;);
      }

      userToDelete.deletedAt &#x3D; new Date();
      userToDelete.updatedBy &#x3D; user;
      userToDelete.isActive &#x3D; 0;
      return await this.userRepository.save(userToDelete);
    } catch (error) {
      throw new Error(&#x60;${UsersService.name}[delete]:${error.message}&#x60;);
    }
  }
}
</code></pre>
    </div>

</div>













                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'UsersService.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script>
               $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               checkToggle(darkModeState);
               if ($darkModeToggleSwitchers.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
